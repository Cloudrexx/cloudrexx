<style type="text/css">
  .input_error{
      border: 1px solid #e00500;
  }
  .half-row {
    width: 48%;
    display: inline-block;
  }
  .row .half-row:last-child {
    margin-left: 3%;
  }
  #multisite_contact_information_form label{
    display: inline-block;
  }
</style>
<div aria-hidden="true" class="modal fade" id="multisite_contact_informaiton" role="dialog" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="grid-elm grid-align-1-1 grid-offset" >
        <h1>{TXT_CORE_MODULE_MULTISITE_CONTACT_INFO_TITTLE}</h1>
        {TXT_CORE_MODULE_MULTISITE_CONTACT_INFO_CONTENT}
        <form role="form" action="{MULTISITE_CONTACT_INFO_SUBMIT_URL}" id="multisite_contact_information_form" autocomplete="off">
          <div class="alert alert-danger validationError" style="display: none;"></div>
          <fieldset>
            <!-- BEGIN multisite_user_profile_gender -->
            <div class="row">
              <label for="{MULTISITE_USER_PROFILE_ATTRIBUTE_GENDER_ID}">{MULTISITE_USER_PROFILE_ATTRIBUTE_GENDER_DESC}</label>{MULTISITE_USER_PROFILE_ATTRIBUTE_GENDER}
            </div>
            <!-- END multisite_user_profile_gender -->

            <div class="row ">
              <!-- BEGIN multisite_user_profile_attribute_firstname -->
              <div class="half-row"><label for="{MULTISITE_USER_PROFILE_ATTRIBUTE_FIRSTNAME_ID}">{MULTISITE_USER_PROFILE_ATTRIBUTE_FIRSTNAME_DESC}</label>&nbsp;{MULTISITE_USER_PROFILE_ATTRIBUTE_FIRSTNAME}</div>
              <!-- END multisite_user_profile_attribute_firstname -->
              <!-- BEGIN multisite_user_profile_attribute_lastname -->
              <div class="half-row"><label for="{MULTISITE_USER_PROFILE_ATTRIBUTE_LASTNAME_ID}">{MULTISITE_USER_PROFILE_ATTRIBUTE_LASTNAME_DESC}</label>&nbsp;{MULTISITE_USER_PROFILE_ATTRIBUTE_LASTNAME}</div>
              <!-- END multisite_user_profile_attribute_lastname -->
            </div>

            <!-- BEGIN multisite_user_profile_attribute_company -->
            <div class="row">
              <label for="{MULTISITE_USER_PROFILE_ATTRIBUTE_COMPANY_ID}">{MULTISITE_USER_PROFILE_ATTRIBUTE_COMPANY_DESC}</label>{MULTISITE_USER_PROFILE_ATTRIBUTE_COMPANY}
            </div>
            <!-- END multisite_user_profile_attribute_company -->
            <!-- BEGIN multisite_user_profile_attribute_address -->
            <div class="row">
              <label for="{MULTISITE_USER_PROFILE_ATTRIBUTE_ADDRESS_ID}">{MULTISITE_USER_PROFILE_ATTRIBUTE_ADDRESS_DESC}</label>&nbsp;{MULTISITE_USER_PROFILE_ATTRIBUTE_ADDRESS}
            </div>
            <!-- END multisite_user_profile_attribute_address -->


            <div class="row">
              <!-- BEGIN multisite_user_profile_attribute_zip -->
              <div class="half-row"><label for="{MULTISITE_USER_PROFILE_ATTRIBUTE_ZIP_ID}">{MULTISITE_USER_PROFILE_ATTRIBUTE_ZIP_DESC}</label>&nbsp;{MULTISITE_USER_PROFILE_ATTRIBUTE_ZIP}</div>
              <!-- END multisite_user_profile_attribute_zip -->
              <!-- BEGIN multisite_user_profile_attribute_city -->
              <div class="half-row"><label for="{MULTISITE_USER_PROFILE_ATTRIBUTE_CITY_ID}">{MULTISITE_USER_PROFILE_ATTRIBUTE_CITY_DESC}</label>&nbsp;{MULTISITE_USER_PROFILE_ATTRIBUTE_CITY}</div>
              <!-- END multisite_user_profile_attribute_city -->
            </div>

            <div class="row">
              <label for="{MULTISITE_USER_PROFILE_ATTRIBUTE_PHONE_OFFICE_ID}">{TXT_CORE_PHONE}</label>{MULTISITE_USER_PROFILE_ATTRIBUTE_PHONE_OFFICE}
            </div>
            <!-- BEGIN multisite_user_profile_attribute_country -->
            <div class="row">
              <label for="{MULTISITE_USER_PROFILE_ATTRIBUTE_COUNTRY_ID}">{MULTISITE_USER_PROFILE_ATTRIBUTE_COUNTRY_DESC}</label>&nbsp;{MULTISITE_USER_PROFILE_ATTRIBUTE_COUNTRY}
            </div>
            <!-- END multisite_user_profile_attribute_country -->
            <div class="row">
              <label>{TXT_CORE_MODULE_MULTISITE_USER_ACCOUNT_INDUSTRY_TYPE}</label> <font color="red">*</font><br />
                <select name="{MULTISITE_INDUSTRY_TYPE_POST_NAME}" id="industryType">
                <option value="">{TXT_CORE_MODULE_MULTISITE_PLEASE_SELECT}</option>
                {CRM_INDUSTRY_DROPDOWN}
              </select>
            </div>
            <div class="row">
              <label>{TXT_CORE_MODULE_MULTISITE_USER_ACCOUNT_COMPANY_SIZE}</label><br />
              <select name="{MULTISITE_COMPANY_SIZE_POST_NAME}" id="companySize">
                <option value="">{TXT_CORE_MODULE_MULTISITE_PLEASE_SELECT}</option>
                <!-- BEGIN companySize -->
                <option value="{CRM_COMPANY_SIZE_ID}" {CRM_COMPANY_SIZE_SELECTED}>{CRM_COMPANY_SIZE}</option>
                <!-- END companySize -->
              </select>
            </div>
            <div class="row">
              <label>{TXT_CORE_MODULE_MULTISITE_USER_ACCOUNT_COMPANY_TYP}</label> <font color="red">*</font><br />
              <select name="{MULTISITE_CUSTOMER_TYPE_POST_NAME}" id="customer_type">
                <option value="">{TXT_CORE_MODULE_MULTISITE_PLEASE_SELECT}</option>
                <!-- BEGIN customerTypes -->
                <option value="{CRM_CUSTOMER_TYPE_ID}" {CRM_CUSTOMER_TYPE_SELECTED}>{CRM_CUSTOMER_TYPE}</option>
                <!-- END customerTypes -->
              </select>
            </div>

            <div class="row">
              <input type="hidden" value="true" name="reload">
              <button type="submit" class="save loadingProcess" data-loading-text="<img src='/lib/javascript/jquery/jstree/themes/default/throbber.gif' /> {TXT_CORE_MODULE_MULTISITE_LOADING_TEXT}">{TXT_CORE_MODULE_MULTISITE_SAVE}</button>
            </div>
          </fieldset>
        </form>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
  /* <![CDATA[ */
  cx.ready(function(){
      jQuery.getScript(cx.variables.get('path', 'contrexx') + "core_modules/MultiSite/View/Script/CustomerPanel.js", function(){
        jQuery('#multisite_contact_information_form').submit(function () {
            jQuery('input, select').removeClass('input_error');
            // MULTISITE_CUSTOMER_TYPE_ATTRIBUT_ID = Id of field where we store the customer type from crm
            var validationFields = ['firstname','lastname','address','zip','city','country', '{MULTISITE_CUSTOMER_TYPE_ATTRIBUT_ID}', '{MULTISITE_INDUSTRY_TYPE_ATTRIBUT_ID}'];
            var error = false;
            jQuery.each(validationFields, function (key, value) {
              var inputFieldName = 'multisite_user_profile_attribute[' + value + '][0]';
              var inputField = jQuery('#multisite_contact_information_form [name="' + inputFieldName + '"]');
              if (inputField.val() == '' || inputField.val() == '0') {
                inputField.addClass('input_error').scroll();
                error = true;
              }
            });
            if (error) {
              jQuery('.validationError').html('{TXT_CORE_MODULE_MULTISITE_MANDATORY_FIELDS_REQUIRED_MSG}');
              jQuery('.alert').show();
              return false;
            }
            sendApiFormRequest('#multisite_contact_information_form',
                               '#multisite_contact_informaiton',
                               '#multisite_user',
                               '/api/MultiSite/User/Summary'
                              );

            return false;
        }); 
      });          
  });

  jQuery(document).ready(function () {
    jQuery('#multisite_contact_informaiton').modal({
            backdrop: 'static',
            keyboard: false
          });
    // remove strong element (mandatory field star) and create a new star next to label for a better layout look
    jQuery('.row,.half-row').each(function(){
        if(jQuery(this).children('strong').remove().length != 0){
            jQuery(this).children('label').after(' <font color="red">*</font>');
        }
    });
  });
  /* ]]> */
</script>